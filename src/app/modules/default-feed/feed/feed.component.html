<m-defaultFeedHeader *ngIf="visibleHeader"></m-defaultFeedHeader>

<div class="m-defaultFeed__feed">
  <m-feedNotice__outlet location="top"></m-feedNotice__outlet>
  <ng-container
    *ngFor="let activity$ of feedsService.feed | async; let i = index"
  >
    <m-feedNotice__outlet
      *ngIf="isLoggedIn() && i > 0 && i % 6 === 0"
      location="inline"
    ></m-feedNotice__outlet>
    <m-featured-content
      *ngIf="shouldShowBoostInPosition(i)"
      [slot]="i + 1"
      [displayOptions]="{
        showOnlyCommentsInput: true,
        isFeed: true
      }"
    ></m-featured-content>
    <m-activity
      [entity]="activity$ | async"
      [displayOptions]="{
        showComments: true,
        isFeed: true,
        hasLoadingPriority: i < 2
      }"
      class="m-defaultFeed__activity"
    ></m-activity>
    <m-publisherRecommendations
      [location]="location"
      [dismissible]="true"
      *ngIf="
        shouldShowPublisherRecommendations(i) &&
        !(isPublisherRecommendationsDismissed$ | async)
      "
      [publisherType]="recommendationsPublisherType"
    ></m-publisherRecommendations>
  </ng-container>

  <infinite-scroll
    (load)="loadNext()"
    [moreData]="feedsService.hasMore | async"
    [inProgress]="feedsService.inProgress | async"
  ></infinite-scroll>
</div>
